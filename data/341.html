<html> 
      <head>
        <title>GAP (ref) - Chapter 84: Interface to the GAP Help System-&gt;84.3 The Help Book Handler</title>
        <meta name="url" content="http://www.gap-system.org/Manuals/doc/ref/chap84.html#X7AD7541E7C30D5B3"></meta>
      </head>
      <body> <h4 xmlns="http://www.w3.org/1999/xhtml">84.3 <span class="Heading">The Help Book Handler</span></h4><p xmlns="http://www.w3.org/1999/xhtml">For each document format <var class="Arg">myownformat</var> there must be a record <code class="code">HELP_BOOK_HANDLER.<var class="Arg">myownformat</var></code> of functions with the following names and functionality.</p><p xmlns="http://www.w3.org/1999/xhtml">An implementation example of such a set of handler functions is the <code class="code">default</code> format, which is the format name used for the <code class="file">gapmacro.tex</code> documentation format, and this is contained in the file <code class="file">lib/helpdef.gi</code>.</p><p xmlns="http://www.w3.org/1999/xhtml">The package <strong class="pkg">GAPDoc</strong> (see Chapter <a shape="rect" href="../../pkg/GAPDoc-1.5.1/doc/chap1_mj.html#X7D4EE663818DA109"><span class="RefLink">GAPDoc: Introduction and Example</span></a>) also defines a format (as it should) which is called: <code class="code">GapDocGAP</code> (the case <em>is</em> significant).</p><p xmlns="http://www.w3.org/1999/xhtml">As you can see by the above two examples, the name for a document format can be anything, but it should be in some way meaningful.</p><dl xmlns="http://www.w3.org/1999/xhtml"><dt><strong class="Mark">
<code class="code">ReadSix( <var class="Arg">stream</var> )</code></strong></dt><dd><p>For an input text stream <var class="Arg">stream</var> to a <code class="file">manual.six</code> file, this must return a record <var class="Arg">info</var> which has at least the following two components: <code class="code">bookname</code> which is the short identifying name of the help book, and <code class="code">entries</code>. Here <var class="Arg">info</var><code class="code">.entries</code> must be a list with one entry per search string (which can be a section header, function name, index entry, or whatever seems sensible to be searched for matching a help query). A <em>match</em> for the <strong class="pkg">GAP</strong> help is a pair (<var class="Arg">info</var>, <var class="Arg">i</var>) where <var class="Arg">i</var> refers to an index for the list <var class="Arg">info</var><code class="code">.entries</code> and this corresponds to a certain position in the document. There is one further regulation for the format of the entries of <var class="Arg">info</var><code class="code">.entries</code>. They must be lists and the first element of such a list must be a string which is printed by <strong class="pkg">GAP</strong> for example when several matches are found for a query (so it should essentially be the string which is searched for the match, except that it may contain upper and lower case letters or some markup). There may be other components in <var class="Arg">info</var> which are needed by the functions below, but their names and formats are not prescribed. The <var class="Arg">stream</var> argument is typically generated using <code class="func">InputTextFile</code> (<a shape="rect" href="chap10_mj.html#X8343D04981128784"><span class="RefLink">10.5-1</span></a>), e.g.</p>


<div class="example"><pre xml:space="preserve">
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">dirs := DirectoriesLibrary( &quot;doc/ref&quot; );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">file := Filename( dirs, &quot;manual.six&quot; );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">stream := InputTextFile( file );;</span>
</pre></div>

</dd><dt><strong class="Mark"><code class="code">ShowChapters( <var class="Arg">info</var> )</code> </strong></dt><dd><p>This must return a text string or list of text lines which contains the chapter headers of the book <var class="Arg">info</var><code class="code">.bookname</code>.</p>

</dd><dt><strong class="Mark"><code class="code">ShowSection( <var class="Arg">info</var> )</code> </strong></dt><dd><p>This must return a text string or list of text lines which contains the section (and chapter) headers of the book <var class="Arg">info</var><code class="code">.bookname</code>.</p>

</dd><dt><strong class="Mark"><code class="code">SearchMatches( <var class="Arg">info</var>, <var class="Arg">topic</var>, <var class="Arg">frombegin</var> )</code> </strong></dt><dd><p>This function must return a list of indices of <var class="Arg">info</var><code class="code">.entries</code> for entries which match the search string <var class="Arg">topic</var>. If <var class="Arg">frombegin</var> is <code class="keyw">true</code> then those parts of <var class="Arg">topic</var> which are separated by spaces should be considered as the beginnings of words to decide the matching. It <var class="Arg">frombegin</var> is <code class="keyw">false</code>, a substring search should be performed. The string <var class="Arg">topic</var> can be assumed to be already normalized (transformed to lower case, and whitespace normalized). The function must return a list with two entries <code class="code">[exact, match]</code> where <code class="code">exact</code> is the list of indices for exact matches and <code class="code">match</code> a list of indices of the remaining matches.</p>

</dd><dt><strong class="Mark"><code class="code">MatchPrevChap( <var class="Arg">info</var>, <var class="Arg">i</var> )</code> </strong></dt><dd><p>This should return the match [<var class="Arg">info</var>, <code class="code">j</code>] which points to the beginning of the chapter containing match [<var class="Arg">info</var>, <var class="Arg">i</var>], respectively to the beginning of the previous chapter if [<var class="Arg">info</var>, <var class="Arg">i</var>] is already the beginning of a chapter. (Corresponds to <code class="code">?&lt;&lt;</code>.)</p>

</dd><dt><strong class="Mark"><code class="code">MatchNextChap( <var class="Arg">info</var>, <var class="Arg">i</var> )</code> </strong></dt><dd><p>Like the previous function except that it should return the match for the beginning of the next chapter. (Corresponds to <code class="code">?&gt;&gt;</code>.)</p>

</dd><dt><strong class="Mark"><code class="code">MatchPrev( <var class="Arg">info</var>, <var class="Arg">i</var> )</code> </strong></dt><dd><p>This should return the previous section (or appropriate portion of the document). (Corresponds to <code class="code">?&lt;</code>.)</p>

</dd><dt><strong class="Mark"><code class="code">MatchNext( <var class="Arg">info</var>, <var class="Arg">i</var> )</code> </strong></dt><dd><p>Like the previous function except that it should return the next section (or appropriate portion of the document). (Corresponds to <code class="code">?&gt;</code>.)</p>

</dd><dt><strong class="Mark"><code class="code">HelpData( <var class="Arg">info</var>, <var class="Arg">i</var>, <var class="Arg">type</var> )</code> </strong></dt><dd><p>This returns for match [<var class="Arg">info</var>, <var class="Arg">i</var>] some data whose format depends on the string <var class="Arg">type</var>, or <code class="keyw">fail</code> if these data are not available. The values of <var class="Arg">type</var> which currently must be handled and the corresponding result format are described in the list below.</p>

</dd></dl><p xmlns="http://www.w3.org/1999/xhtml">The <code class="code">HELP_BOOK_HANDLER.<var class="Arg">myownformat</var>.HelpData</code> function must recognize the following values of the <var class="Arg">type</var> argument.</p><dl xmlns="http://www.w3.org/1999/xhtml"><dt><strong class="Mark">
<code class="code">&quot;text&quot;</code> </strong></dt><dd><p>This must return a corresponding text string in a format which can be fed into the <code class="code">Pager</code>, see <code class="func">Pager</code> (<a shape="rect" href="chap2_mj.html#X7ED03E41792C3840"><span class="RefLink">2.4-1</span></a>).</p>

</dd><dt><strong class="Mark"><code class="code">&quot;url&quot;</code> </strong></dt><dd><p>If the help book is available in HTML format this must return an URL as a string (Probably a <code class="code">file://</code> URL containing a label for the exact start position in that file). Otherwise it returns <code class="keyw">fail</code>.</p>

</dd><dt><strong class="Mark"><code class="code">&quot;dvi&quot;</code> </strong></dt><dd><p>If the help book is available in dvi-format this must return a record of form <code class="code">rec( file := <var class="Arg">filename</var>, page := <var class="Arg">pagenumber</var> )</code>. Otherwise it returns <code class="keyw">fail</code>.</p>

</dd><dt><strong class="Mark"><code class="code">&quot;pdf&quot;</code> </strong></dt><dd><p>Same as case <code class="code">&quot;dvi&quot;</code>, but for the corresponding pdf-file.</p>

</dd><dt><strong class="Mark"><code class="code">&quot;secnr&quot;</code> </strong></dt><dd><p>This must return a pair like <code class="code">[[3,3,1], &quot;3.3.1&quot;]</code> which gives the section number as chapter number, section number, subsection number triple and a corresponding string (a chapter itself is encoded like <code class="code">[[4,0,0], &quot;4.&quot;]</code>). Useful for cross-referencing between help books.</p>

</dd></dl> </body>
    </html>