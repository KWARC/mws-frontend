<html> 
      <head>
        <title>GAP (ref) - Chapter 12: Objects and Elements-&gt;12.6-6 Mutability of Results of Arithmetic Operations</title>
        <meta name="url" content="http://www.gap-system.org/Manuals/doc/ref/chap12.html#X7ADB82997A16E853"></meta>
      </head>
      <body> <h5 xmlns="http://www.w3.org/1999/xhtml">12.6-6 <span class="Heading">Mutability of Results of Arithmetic Operations</span></h5><p xmlns="http://www.w3.org/1999/xhtml">Many operations return immutable results, among those in particular attributes (see <a shape="rect" href="chap13_mj.html#X7C701DBF7BAE649A"><span class="RefLink">13.5</span></a>). Examples of attributes are <code class="func">Size</code> (<a shape="rect" href="chap30_mj.html#X858ADA3B7A684421"><span class="RefLink">30.4-6</span></a>), <code class="func">Zero</code> (<a shape="rect" href="chap31_mj.html#X8040AC7A79FFC442"><span class="RefLink">31.10-3</span></a>), <code class="func">AdditiveInverse</code> (<a shape="rect" href="chap31_mj.html#X84BB723C81D55D63"><span class="RefLink">31.10-9</span></a>), <code class="func">One</code> (<a shape="rect" href="chap31_mj.html#X8046262384895B2A"><span class="RefLink">31.10-2</span></a>), and <code class="func">Inverse</code> (<a shape="rect" href="chap31_mj.html#X78EE524E83624057"><span class="RefLink">31.10-8</span></a>). Arithmetic operations, such as the binary infix operations <code class="code">+</code>, <code class="code">-</code>, <code class="code">*</code>, <code class="code">/</code>, <code class="code">^</code>, <code class="keyw">mod</code>, the unary <code class="code">-</code>, and operations such as <code class="func">Comm</code> (<a shape="rect" href="chap31_mj.html#X80761843831B468E"><span class="RefLink">31.12-3</span></a>) and <code class="func">LeftQuotient</code> (<a shape="rect" href="chap31_mj.html#X7A37082878DB3930"><span class="RefLink">31.12-2</span></a>), return <em>mutable</em> results, <em>except</em> if all arguments are immutable. So the product of two matrices or of a vector and a matrix is immutable if and only if the two matrices or both the vector and the matrix are immutable (see also <a shape="rect" href="chap21_mj.html#X845EEAF083D43CCE"><span class="RefLink">21.11</span></a>). There is one exception to this rule, which arises where the result is less deeply nested than at least one of the argument, where mutable arguments may sometimes lead to an immutable result. For instance, a mutable matrix with immutable rows, multiplied by an immutable vector gives an immutable vector result. The exact rules are given in <a shape="rect" href="chap21_mj.html#X845EEAF083D43CCE"><span class="RefLink">21.11</span></a>.</p><p xmlns="http://www.w3.org/1999/xhtml">It should be noted that <code class="code">0 * <var class="Arg">obj</var></code> is equivalent to <code class="code">ZeroSM( <var class="Arg">obj</var> )</code>, <code class="code">-<var class="Arg">obj</var></code> is equivalent to <code class="code">AdditiveInverseSM( <var class="Arg">obj</var> )</code>, <code class="code"><var class="Arg">obj</var>^0</code> is equivalent to <code class="code">OneSM( <var class="Arg">obj</var>)</code>, and <code class="code"><var class="Arg">obj</var>^-1</code> is equivalent to <code class="code">InverseSM( <var class="Arg">obj</var> )</code>. The &quot;SM&quot; stands for &quot;same mutability&quot;, and indicates that the result is mutable if and only if the argument is mutable.</p><p xmlns="http://www.w3.org/1999/xhtml">The operations <code class="func">ZeroOp</code> (<a shape="rect" href="chap31_mj.html#X8040AC7A79FFC442"><span class="RefLink">31.10-3</span></a>), <code class="func">AdditiveInverseOp</code> (<a shape="rect" href="chap31_mj.html#X84BB723C81D55D63"><span class="RefLink">31.10-9</span></a>), <code class="func">OneOp</code> (<a shape="rect" href="chap31_mj.html#X8046262384895B2A"><span class="RefLink">31.10-2</span></a>), and <code class="func">InverseOp</code> (<a shape="rect" href="chap31_mj.html#X78EE524E83624057"><span class="RefLink">31.10-8</span></a>) return <em>mutable</em> results whenever a mutable version of the result exists, contrary to the attributes <code class="func">Zero</code> (<a shape="rect" href="chap31_mj.html#X8040AC7A79FFC442"><span class="RefLink">31.10-3</span></a>), <code class="func">AdditiveInverse</code> (<a shape="rect" href="chap31_mj.html#X84BB723C81D55D63"><span class="RefLink">31.10-9</span></a>), <code class="func">One</code> (<a shape="rect" href="chap31_mj.html#X8046262384895B2A"><span class="RefLink">31.10-2</span></a>), and <code class="func">Inverse</code> (<a shape="rect" href="chap31_mj.html#X78EE524E83624057"><span class="RefLink">31.10-8</span></a>).</p><p xmlns="http://www.w3.org/1999/xhtml">If one introduces new arithmetic objects then one need not install methods for the attributes <code class="func">One</code> (<a shape="rect" href="chap31_mj.html#X8046262384895B2A"><span class="RefLink">31.10-2</span></a>), <code class="func">Zero</code> (<a shape="rect" href="chap31_mj.html#X8040AC7A79FFC442"><span class="RefLink">31.10-3</span></a>), etc. The methods for the associated operations <code class="func">OneOp</code> (<a shape="rect" href="chap31_mj.html#X8046262384895B2A"><span class="RefLink">31.10-2</span></a>) and <code class="func">ZeroOp</code> (<a shape="rect" href="chap31_mj.html#X8040AC7A79FFC442"><span class="RefLink">31.10-3</span></a>) will be called, and then the results made immutable.</p><p xmlns="http://www.w3.org/1999/xhtml">All methods installed for the arithmetic operations must obey the rule about the mutability of the result. This means that one may try to avoid the perhaps expensive creation of a new object if both operands are immutable, and of course no problems of this kind arise at all in the (usual) case that the objects in question do not admit a mutable form, i.e., that these objects are not copyable.</p><p xmlns="http://www.w3.org/1999/xhtml">In a few, relatively low-level algorithms, one wishes to treat a matrix partly as a data structure, and manipulate and change its entries. For this, the matrix needs to be mutable, and the rule that attribute values are immutable is an obstacle. For these situations, a number of additional operations are provided, for example <code class="func">TransposedMatMutable</code> (<a shape="rect" href="chap24_mj.html#X7C52A38C79C36C35"><span class="RefLink">24.5-6</span></a>) constructs a mutable matrix (contrary to the attribute <code class="func">TransposedMat</code> (<a shape="rect" href="chap24_mj.html#X7C52A38C79C36C35"><span class="RefLink">24.5-6</span></a>)), while <code class="func">TriangulizeMat</code> (<a shape="rect" href="chap24_mj.html#X8384CA8E7B3850D3"><span class="RefLink">24.7-3</span></a>) modifies a mutable matrix (in place) into upper triangular form.</p><p xmlns="http://www.w3.org/1999/xhtml">Note that being immutable does not forbid an object to store knowledge. For example, if it is found out that an immutable list is strictly sorted then the list may store this information. More precisely, an immutable object may change in any way, provided that it continues to represent the same mathematical object.</p> </body>
    </html>