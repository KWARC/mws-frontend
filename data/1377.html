<html> 
      <head>
        <title>GAP (ref) - Chapter 11: Processes &amp;#8614; 11.1-1 Process</title>
        <meta name="url" content="http://www.gap-system.org/Manuals/doc/ref/chap11_mj.html#X7B09033178D1107A"></meta>
      </head>
      <body> <h5 xmlns="http://www.w3.org/1999/xhtml">11.1-1 Process</h5><div class="func" xmlns="http://www.w3.org/1999/xhtml"><table width="100%" class="func"><tbody><tr><td colspan="1" rowspan="1" class="tdleft"><code class="func">‣ Process</code>( <var class="Arg">dir</var>, <var class="Arg">prg</var>, <var class="Arg">stream-in</var>, <var class="Arg">stream-out</var>, <var class="Arg">options</var> )</td><td colspan="1" rowspan="1" class="tdright">( operation )</td></tr></tbody></table></div><p xmlns="http://www.w3.org/1999/xhtml"><code class="func">Process</code> runs a new process and returns when the process terminates. It returns the return value of the process if the operating system supports such a concept.</p><p xmlns="http://www.w3.org/1999/xhtml">The first argument <var class="Arg">dir</var> is a directory object (see <a shape="rect" href="chap9_mj.html#X85030B35865A1080"><span class="RefLink">9.3</span></a>) which will be the current directory (in the usual UNIX or MSDOS sense) when the program is run. This will only matter if the program accesses files (including running other programs) via relative path names. In particular, it has nothing to do with finding the binary to run.</p><p xmlns="http://www.w3.org/1999/xhtml">In general the directory will either be the current directory, which is returned by <code class="func">DirectoryCurrent</code> (<a shape="rect" href="chap9_mj.html#X7BAD8036849E8430"><span class="RefLink">9.3-4</span></a>) –this was the behaviour of <strong class="pkg">GAP</strong> 3– or a temporary directory returned by <code class="func">DirectoryTemporary</code> (<a shape="rect" href="chap9_mj.html#X8222B1A886E6195E"><span class="RefLink">9.3-3</span></a>). If one expects that the process creates temporary or log files the latter should be used because <strong class="pkg">GAP</strong> will attempt to remove these directories together with all the files in them when quitting.</p><p xmlns="http://www.w3.org/1999/xhtml">If a program of a <strong class="pkg">GAP</strong> package which does not only consist of <strong class="pkg">GAP</strong> code needs to be launched in a directory relative to certain data libraries, then the first entry of <code class="func">DirectoriesPackageLibrary</code> (<a shape="rect" href="chap76_mj.html#X807D835C7B032D4E"><span class="RefLink">76.3-5</span></a>) should be used. The argument of <code class="func">DirectoriesPackageLibrary</code> (<a shape="rect" href="chap76_mj.html#X807D835C7B032D4E"><span class="RefLink">76.3-5</span></a>) should be the path to the data library relative to the package directory.</p><p xmlns="http://www.w3.org/1999/xhtml">If a program calls other programs and needs to be launched in a directory containing the executables for such a <strong class="pkg">GAP</strong> package then the first entry of <code class="func">DirectoriesPackagePrograms</code> (<a shape="rect" href="chap76_mj.html#X794508E5811D3BC9"><span class="RefLink">76.3-6</span></a>) should be used.</p><p xmlns="http://www.w3.org/1999/xhtml">The latter two alternatives should only be used if absolutely necessary because otherwise one risks accumulating log or core files in the package directory.</p><div class="example" xmlns="http://www.w3.org/1999/xhtml"><pre xml:space="preserve">
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">path := DirectoriesSystemPrograms();;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ls := Filename( path, &quot;ls&quot; );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">stdin := InputTextUser();;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">stdout := OutputTextUser();;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Process( path[1], ls, stdin, stdout, [&quot;-c&quot;] );;</span>
awk    ls     mkdir
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput"># current directory, here the root directory</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Process( DirectoryCurrent(), ls, stdin, stdout, [&quot;-c&quot;] );;</span>
bin    lib    trans  tst    CVS    grp    prim   thr    two
src    dev    etc    tbl    doc    pkg    small  tom
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput"># create a temporary directory</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">tmpdir := DirectoryTemporary();;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Process( tmpdir, ls, stdin, stdout, [&quot;-c&quot;] );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">PrintTo( Filename( tmpdir, &quot;emil&quot; ) );</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Process( tmpdir, ls, stdin, stdout, [&quot;-c&quot;] );;</span>
emil
</pre></div><p xmlns="http://www.w3.org/1999/xhtml"><var class="Arg">prg</var> is the filename of the program to launch, for portability it should be the result of <code class="func">Filename</code> (<a shape="rect" href="chap9_mj.html#X7E352E1F87060602"><span class="RefLink">9.4-1</span></a>) and should pass <code class="func">IsExecutableFile</code> (<a shape="rect" href="chap9_mj.html#X83A1AAD58435FC4C"><span class="RefLink">9.6-4</span></a>). Note that <code class="func">Process</code> does <em>no</em> searching through a list of directories, this is done by <code class="func">Filename</code> (<a shape="rect" href="chap9_mj.html#X7E352E1F87060602"><span class="RefLink">9.4-1</span></a>).</p><p xmlns="http://www.w3.org/1999/xhtml"><var class="Arg">stream-in</var> is the input stream that delivers the characters to the process. For portability it should either be <code class="func">InputTextNone</code> (<a shape="rect" href="chap10_mj.html#X7C732324806716C6"><span class="RefLink">10.9-1</span></a>) (if the process reads no characters), <code class="func">InputTextUser</code> (<a shape="rect" href="chap10_mj.html#X83531E4C7C53544F"><span class="RefLink">10.6-1</span></a>), the result of a call to <code class="func">InputTextFile</code> (<a shape="rect" href="chap10_mj.html#X8343D04981128784"><span class="RefLink">10.5-1</span></a>) from which no characters have been read, or the result of a call to <code class="func">InputTextString</code> (<a shape="rect" href="chap10_mj.html#X7ABABCDF7ED81F7F"><span class="RefLink">10.7-1</span></a>).</p><p xmlns="http://www.w3.org/1999/xhtml"><code class="func">Process</code> is free to consume <em>all</em> the input even if the program itself does not require any input at all.</p><p xmlns="http://www.w3.org/1999/xhtml"><var class="Arg">stream-out</var> is the output stream which receives the characters from the process. For portability it should either be <code class="func">OutputTextNone</code> (<a shape="rect" href="chap10_mj.html#X7CC5C1FC81715E38"><span class="RefLink">10.9-2</span></a>) (if the process writes no characters), <code class="func">OutputTextUser</code> (<a shape="rect" href="chap10_mj.html#X83E5FC9487766297"><span class="RefLink">10.6-2</span></a>), the result of a call to <code class="func">OutputTextFile</code> (<a shape="rect" href="chap10_mj.html#X83F53291822B7126"><span class="RefLink">10.5-2</span></a>) to which no characters have been written, or the result of a call to <code class="func">OutputTextString</code> (<a shape="rect" href="chap10_mj.html#X7FEDA5167979B74D"><span class="RefLink">10.7-2</span></a>).</p><p xmlns="http://www.w3.org/1999/xhtml"><var class="Arg">options</var> is a list of strings which are passed to the process as command line argument. Note that no substitutions are performed on the strings, i.e., they are passed immediately to the process and are not processed by a command interpreter (shell). Further note that each string is passed as one argument, even if it contains <em>space</em> characters. Note that input/output redirection commands are <em>not</em> allowed as <var class="Arg">options</var>.</p><p xmlns="http://www.w3.org/1999/xhtml">In order to find a system program use <code class="func">DirectoriesSystemPrograms</code> (<a shape="rect" href="chap9_mj.html#X808E2C187DD984B4"><span class="RefLink">9.3-6</span></a>) together with <code class="func">Filename</code> (<a shape="rect" href="chap9_mj.html#X7E352E1F87060602"><span class="RefLink">9.4-1</span></a>).</p><div class="example" xmlns="http://www.w3.org/1999/xhtml"><pre xml:space="preserve">
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">path := DirectoriesSystemPrograms();;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">date := Filename( path, &quot;date&quot; );</span>
&quot;/bin/date&quot;
</pre></div><p xmlns="http://www.w3.org/1999/xhtml">The next example shows how to execute <code class="code">date</code> with no argument and no input, and collect the output into a string stream.</p><div class="example" xmlns="http://www.w3.org/1999/xhtml"><pre xml:space="preserve">
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">str := &quot;&quot;;; a := OutputTextString(str,true);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Process( DirectoryCurrent(), date, InputTextNone(), a, [] );</span>
0
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">CloseStream(a);</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Print(str);</span>
Fri Jul 11 09:04:23 MET DST 1997
</pre></div> </body>
    </html>