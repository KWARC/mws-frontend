<html> 
      <head>
        <title>GAP (ref) - Chapter 19: Floats-&gt;19.2 Methods</title>
        <meta name="url" content="http://www.gap-system.org/Manuals/doc/ref/chap19.html#X8606FDCE878850EF"></meta>
      </head>
      <body> <h4 xmlns="http://www.w3.org/1999/xhtml">19.2 <span class="Heading">Methods</span></h4><p xmlns="http://www.w3.org/1999/xhtml">Floating-point numbers may be directly input, as in any usual mathematical software or language; with the exception that every floating-point number must contain a decimal digit. Therefore <code class="code">.1</code>, <code class="code">.1e1</code>, <code class="code">-.999</code> etc. are all valid <strong class="pkg">GAP</strong> inputs.</p><p xmlns="http://www.w3.org/1999/xhtml">Floating-point numbers so entered in <strong class="pkg">GAP</strong> are stored as strings. They are converted to floating-point when they are first used. This means that, if the floating-point precision is increased, the constants are reevaluated to fit the new format.</p><p xmlns="http://www.w3.org/1999/xhtml">Floating-point numbers may be followed by an underscore, as in <code class="code">1._</code>. This means that they are to be immediately converted to the current floating-point format. The underscore may be followed by a single letter, which specifies which format/precision to use. By default, <strong class="pkg">GAP</strong> has a single floating-point handler, with fixed (53 bits) precision, and its format specifier is <code class="code">'l'</code> as in <code class="code">1._l</code>. Higher-precision floating-point computations is available via external packages; <strong class="pkg">float</strong> for example.</p><p xmlns="http://www.w3.org/1999/xhtml">A record, <code class="func">FLOAT</code> (<a shape="rect" href="chap19_mj.html#X819050BF8403806E"><span class="RefLink">19.2-6</span></a>), contains all relevant constants for the current floating-point format; see its documentation for details. Typical fields are <code class="code">FLOAT.MANT_DIG=53</code>, the constant <code class="code">FLOAT.VIEW_DIG=6</code> specifying the number of digits to view, and <code class="code">FLOAT.PI</code> for the constant <math id="-4894973457554148685" display="inline" alttext="\pi" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">œÄ</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">ùúã</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">\pi</annotation>
  </semantics>
</math>. The constants have the same name as their C counterparts, except for the missing initial <code class="code">DBL_</code> or <code class="code">M_</code>.</p><p xmlns="http://www.w3.org/1999/xhtml">Floating-point numbers may be created using the single function <code class="func">Float</code> (<a shape="rect" href="chap19_mj.html#X873D56F67DD887C5"><span class="RefLink">19.2-7</span></a>), which accepts as arguments rational, string, or floating-point numbers. Floating-point numbers may also be created, in any floating-point representation, using <code class="func">NewFloat</code> (<a shape="rect" href="chap19_mj.html#X873D56F67DD887C5"><span class="RefLink">19.2-7</span></a>) as in <code class="code">NewFloat(IsIEEE754FloatRep,355/113)</code>, by supplying the category filter of the desired new floating-point number; or using <code class="func">MakeFloat</code> (<a shape="rect" href="chap19_mj.html#X873D56F67DD887C5"><span class="RefLink">19.2-7</span></a>) as in <code class="code">NewFloat(1.0,355/113)</code>, by supplying a sample floating-point number.</p><p xmlns="http://www.w3.org/1999/xhtml">Floating-point numbers may also be converted to other <strong class="pkg">GAP</strong> formats using the usual commands <code class="func">Int</code> (<a shape="rect" href="chap14_mj.html#X87CA734380B5F68C"><span class="RefLink">14.2-3</span></a>), <code class="func">Rat</code> (<a shape="rect" href="chap17_mj.html#X7EB4C646806A2BDE"><span class="RefLink">17.2-6</span></a>), <code class="func">String</code> (<a shape="rect" href="chap27_mj.html#X81FB5BE27903EC32"><span class="RefLink">27.7-6</span></a>).</p><p xmlns="http://www.w3.org/1999/xhtml">Exact conversion to and from floating-point format may be done using external representations. The &quot;external representation&quot; of a floating-point number <code class="code">x</code> is a pair <code class="code">[m,e]</code> of integers, such that <code class="code">x=m*2^(-1+e-LogInt(AbsInt(m),2))</code>. Conversion to and from external representation is performed as usual using <code class="func">ExtRepOfObj</code> (<a shape="rect" href="chap79_mj.html#X8542B32A8206118C"><span class="RefLink">79.16-1</span></a>) and <code class="func">ObjByExtRep</code> (<a shape="rect" href="chap79_mj.html#X8542B32A8206118C"><span class="RefLink">79.16-1</span></a>):</p><div class="example" xmlns="http://www.w3.org/1999/xhtml"><pre xml:space="preserve">
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ExtRepOfObj(3.14);</span>
[ 7070651414971679, 2 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ObjByExtRep(IEEE754FloatsFamily,last);</span>
3.14
</pre></div><p xmlns="http://www.w3.org/1999/xhtml">Computations with floating-point numbers never raise any error. Division by zero is allowed, and produces a signed infinity. Illegal operations, such as <code class="code">0./0.</code>, produce <code class="keyw">NaN</code>'s (not-a-number); this is the only floating-point number <code class="code">x</code> such that <code class="code">not EqFloat(x+0.0,x)</code>.</p><p xmlns="http://www.w3.org/1999/xhtml">The IEEE754 standard requires <code class="keyw">NaN</code> to be non-equal to itself. On the other hand, <strong class="pkg">GAP</strong> requires every object to be equal to itself. To respect the IEEE754 standard, the function <code class="func">EqFloat</code> (<a shape="rect" href="chap19_mj.html#X7BD96E0585D5A1EE"><span class="RefLink">19.2-2</span></a>) should be used instead of <code class="code">=</code>.</p><p xmlns="http://www.w3.org/1999/xhtml">The category a floating-point belongs to can be checked using the filters <code class="func">IsFinite</code> (<a shape="rect" href="chap30_mj.html#X808A4061809A6E67"><span class="RefLink">30.4-2</span></a>), <code class="func">IsPInfinity</code> (<a shape="rect" href="chap19_mj.html#X7DB3BC76836E6219"><span class="RefLink">19.2-5</span></a>), <code class="func">IsNInfinity</code> (<a shape="rect" href="chap19_mj.html#X7DB3BC76836E6219"><span class="RefLink">19.2-5</span></a>), <code class="func">IsXInfinity</code> (<a shape="rect" href="chap19_mj.html#X7DB3BC76836E6219"><span class="RefLink">19.2-5</span></a>), <code class="func">IsNaN</code> (<a shape="rect" href="chap19_mj.html#X7DB3BC76836E6219"><span class="RefLink">19.2-5</span></a>).</p><p xmlns="http://www.w3.org/1999/xhtml">Comparisons between floating-point numbers and rationals are explicitly forbidden. The rationale is that objects belonging to different families should in general not be comparable in <strong class="pkg">GAP</strong>. Floating-point numbers are also approximations of real numbers, and don't follow the same rules; consider for example, using the default <strong class="pkg">GAP</strong> implementation of floating-point numbers,</p><div class="example" xmlns="http://www.w3.org/1999/xhtml"><pre xml:space="preserve">
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">1.0/3.0 = Float(1/3);</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">(1.0/3.0)^5 = Float((1/3)^5);</span>
false
</pre></div> </body>
    </html>