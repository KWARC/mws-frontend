<html> 
      <head>
        <title>GAP (ref) - Chapter 60: Abelian Number Fields-&gt;60.3 Integral Bases of Abelian Number Fields</title>
        <meta name="url" content="http://www.gap-system.org/Manuals/doc/ref/chap60.html#X7D2421AC8491D2BE"></meta>
      </head>
      <body> <h4 xmlns="http://www.w3.org/1999/xhtml">60.3 <span class="Heading">Integral Bases of Abelian Number Fields</span></h4><p xmlns="http://www.w3.org/1999/xhtml">Each abelian number field is naturally a vector space over <math id="2814763650046494657" display="inline" alttext="?" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1" mathvariant="normal">?</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">?</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">?</annotation>
  </semantics>
</math>. Moreover, if the abelian number field <math id="2818958025700258338" display="inline" alttext="F" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">F</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝐹</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">F</annotation>
  </semantics>
</math> contains the <math id="-5814227497480637984" display="inline" alttext="n" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">n</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑛</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">n</annotation>
  </semantics>
</math>-th cyclotomic field <math id="7303040249524433484" display="inline" alttext="?_{n}" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <msub xref="p1.1.m1.1.3.cmml" id="p1.1.m1.1.3">
      <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1" mathvariant="normal">?</mi>
      <mi xref="p1.1.m1.1.2.1.cmml" id="p1.1.m1.1.2.1">n</mi>
    </msub>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <apply xref="p1.1.m1.1.3" id="p1.1.m1.1.3.cmml">
        <csymbol id="p1.1.m1.1.3.1.cmml" cd="ambiguous">subscript</csymbol>
        <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">?</ci>
        <ci xref="p1.1.m1.1.2.1" id="p1.1.m1.1.2.1.cmml">𝑛</ci>
      </apply>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">?_{n}</annotation>
  </semantics>
</math> then <math id="7792739415497548236" display="inline" alttext="F" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">F</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝐹</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">F</annotation>
  </semantics>
</math> is a vector space over <math id="1893931476682388470" display="inline" alttext="?_{n}" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <msub xref="p1.1.m1.1.3.cmml" id="p1.1.m1.1.3">
      <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1" mathvariant="normal">?</mi>
      <mi xref="p1.1.m1.1.2.1.cmml" id="p1.1.m1.1.2.1">n</mi>
    </msub>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <apply xref="p1.1.m1.1.3" id="p1.1.m1.1.3.cmml">
        <csymbol id="p1.1.m1.1.3.1.cmml" cd="ambiguous">subscript</csymbol>
        <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">?</ci>
        <ci xref="p1.1.m1.1.2.1" id="p1.1.m1.1.2.1.cmml">𝑛</ci>
      </apply>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">?_{n}</annotation>
  </semantics>
</math>. In <strong class="pkg">GAP</strong>, each field object represents a vector space object over a certain subfield <math id="1827724281800500749" display="inline" alttext="S" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">S</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑆</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">S</annotation>
  </semantics>
</math>, which depends on the way <math id="-5460938430426530687" display="inline" alttext="F" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">F</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝐹</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">F</annotation>
  </semantics>
</math> was constructed. The subfield <math id="82186915465181617" display="inline" alttext="S" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">S</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑆</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">S</annotation>
  </semantics>
</math> can be accessed as the value of the attribute <code class="func">LeftActingDomain</code> (<a shape="rect" href="chap57_mj.html#X86F070E0807DC34E"><span class="RefLink">57.1-11</span></a>).</p><p xmlns="http://www.w3.org/1999/xhtml">The return values of <code class="func">NF</code> (<a shape="rect" href="chap60_mj.html#X80E5AD028143E11E"><span class="RefLink">60.1-2</span></a>) and of the one argument versions of <code class="func">CF</code> (<a shape="rect" href="chap60_mj.html#X80D21D80850EFA4B"><span class="RefLink">60.1-1</span></a>) represent vector spaces over <math id="-2595654170991856496" display="inline" alttext="?" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1" mathvariant="normal">?</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">?</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">?</annotation>
  </semantics>
</math>, and the return values of the two argument version of <code class="func">CF</code> (<a shape="rect" href="chap60_mj.html#X80D21D80850EFA4B"><span class="RefLink">60.1-1</span></a>) represent vector spaces over the field that is given as the first argument. For an abelian number field <var class="Arg">F</var> and a subfield <var class="Arg">S</var> of <var class="Arg">F</var>, a <strong class="pkg">GAP</strong> object representing <var class="Arg">F</var> as a vector space over <var class="Arg">S</var> can be constructed using <code class="func">AsField</code> (<a shape="rect" href="chap58_mj.html#X7C193B7D7AFB29BE"><span class="RefLink">58.1-9</span></a>).</p><p xmlns="http://www.w3.org/1999/xhtml">Let <var class="Arg">F</var> be the cyclotomic field <math id="4540154560356934114" display="inline" alttext="?_{n}" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <msub xref="p1.1.m1.1.3.cmml" id="p1.1.m1.1.3">
      <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1" mathvariant="normal">?</mi>
      <mi xref="p1.1.m1.1.2.1.cmml" id="p1.1.m1.1.2.1">n</mi>
    </msub>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <apply xref="p1.1.m1.1.3" id="p1.1.m1.1.3.cmml">
        <csymbol id="p1.1.m1.1.3.1.cmml" cd="ambiguous">subscript</csymbol>
        <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">?</ci>
        <ci xref="p1.1.m1.1.2.1" id="p1.1.m1.1.2.1.cmml">𝑛</ci>
      </apply>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">?_{n}</annotation>
  </semantics>
</math>, represented as a vector space over the subfield <var class="Arg">S</var>. If <var class="Arg">S</var> is the cyclotomic field <math id="-3854309742272216641" display="inline" alttext="?_{m}" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <msub xref="p1.1.m1.1.3.cmml" id="p1.1.m1.1.3">
      <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1" mathvariant="normal">?</mi>
      <mi xref="p1.1.m1.1.2.1.cmml" id="p1.1.m1.1.2.1">m</mi>
    </msub>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <apply xref="p1.1.m1.1.3" id="p1.1.m1.1.3.cmml">
        <csymbol id="p1.1.m1.1.3.1.cmml" cd="ambiguous">subscript</csymbol>
        <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">?</ci>
        <ci xref="p1.1.m1.1.2.1" id="p1.1.m1.1.2.1.cmml">𝑚</ci>
      </apply>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">?_{m}</annotation>
  </semantics>
</math>, with <math id="9000716819841375178" display="inline" alttext="m" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">m</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑚</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">m</annotation>
  </semantics>
</math> a divisor of <math id="1421585720442261433" display="inline" alttext="n" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">n</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑛</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">n</annotation>
  </semantics>
</math>, then <code class="code">CanonicalBasis( <var class="Arg">F</var> )</code> returns the Zumbroich basis of <var class="Arg">F</var> relative to <var class="Arg">S</var>, which consists of the roots of unity <code class="code">E(<var class="Arg">n</var>)</code>^<var class="Arg">i</var> where <var class="Arg">i</var> is an element of the list <code class="code">ZumbroichBase( <var class="Arg">n</var>, <var class="Arg">m</var> )</code> (see <code class="func">ZumbroichBase</code> (<a shape="rect" href="chap60_mj.html#X7F52BEA0862E06F2"><span class="RefLink">60.3-1</span></a>)). If <var class="Arg">S</var> is an abelian number field that is not a cyclotomic field then <code class="code">CanonicalBasis( <var class="Arg">F</var> )</code> returns a normal <var class="Arg">S</var>-basis of <var class="Arg">F</var>, i.e., a basis that is closed under the field automorphisms of <var class="Arg">F</var>.</p><p xmlns="http://www.w3.org/1999/xhtml">Let <var class="Arg">F</var> be the abelian number field <code class="code">NF( <var class="Arg">n</var>, <var class="Arg">stab</var> )</code>, with conductor <var class="Arg">n</var>, that is itself not a cyclotomic field, represented as a vector space over the subfield <var class="Arg">S</var>. If <var class="Arg">S</var> is the cyclotomic field <math id="-2861539789356433697" display="inline" alttext="?_{m}" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <msub xref="p1.1.m1.1.3.cmml" id="p1.1.m1.1.3">
      <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1" mathvariant="normal">?</mi>
      <mi xref="p1.1.m1.1.2.1.cmml" id="p1.1.m1.1.2.1">m</mi>
    </msub>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <apply xref="p1.1.m1.1.3" id="p1.1.m1.1.3.cmml">
        <csymbol id="p1.1.m1.1.3.1.cmml" cd="ambiguous">subscript</csymbol>
        <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">?</ci>
        <ci xref="p1.1.m1.1.2.1" id="p1.1.m1.1.2.1.cmml">𝑚</ci>
      </apply>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">?_{m}</annotation>
  </semantics>
</math>, with <math id="-4688218058257237178" display="inline" alttext="m" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">m</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑚</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">m</annotation>
  </semantics>
</math> a divisor of <math id="-4211080272741908416" display="inline" alttext="n" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">n</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑛</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">n</annotation>
  </semantics>
</math>, then <code class="code">CanonicalBasis( <var class="Arg">F</var> )</code> returns the Lenstra basis of <var class="Arg">F</var> relative to <var class="Arg">S</var> that consists of the sums of roots of unity described by <code class="code">LenstraBase( <var class="Arg">n</var>, <var class="Arg">stab</var>, <var class="Arg">stab</var>, <var class="Arg">m</var> )</code> (see <code class="func">LenstraBase</code> (<a shape="rect" href="chap60_mj.html#X87DB9C2C858B722A"><span class="RefLink">60.3-2</span></a>)). If <var class="Arg">S</var> is an abelian number field that is not a cyclotomic field then <code class="code">CanonicalBasis( <var class="Arg">F</var> )</code> returns a normal <var class="Arg">S</var>-basis of <var class="Arg">F</var>.</p><div class="example" xmlns="http://www.w3.org/1999/xhtml"><pre xml:space="preserve">
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f:= CF(8);;   # a cycl. field over the rationals</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">b:= CanonicalBasis( f );;  BasisVectors( b );</span>
[ 1, E(8), E(4), E(8)^3 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Coefficients( b, Sqrt(-2) );</span>
[ 0, 1, 0, 1 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f:= AsField( CF(4), CF(8) );;  # a cycl. field over a cycl. field</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">b:= CanonicalBasis( f );;  BasisVectors( b );</span>
[ 1, E(8) ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Coefficients( b, Sqrt(-2) );</span>
[ 0, 1+E(4) ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f:= AsField( Field( [ Sqrt(-2) ] ), CF(8) );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput"># a cycl. field over a non-cycl. field</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">b:= CanonicalBasis( f );;  BasisVectors( b );</span>
[ 1/2+1/2*E(8)-1/2*E(8)^2-1/2*E(8)^3, 
  1/2-1/2*E(8)+1/2*E(8)^2+1/2*E(8)^3 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Coefficients( b, Sqrt(-2) );</span>
[ E(8)+E(8)^3, E(8)+E(8)^3 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f:= Field( [ Sqrt(-2) ] );   # a non-cycl. field over the rationals</span>
NF(8,[ 1, 3 ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">b:= CanonicalBasis( f );;  BasisVectors( b );</span>
[ 1, E(8)+E(8)^3 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Coefficients( b, Sqrt(-2) );</span>
[ 0, 1 ]
</pre></div> </body>
    </html>