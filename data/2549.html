<html> 
      <head>
        <title>GAP (ref) - Chapter 15: Number Theory &amp;#8614; 15.7-1 TwoSquares</title>
        <meta name="url" content="http://www.gap-system.org/Manuals/doc/ref/chap15_mj.html#X85E1EFC484F648A4"></meta>
      </head>
      <body> <h5 xmlns="http://www.w3.org/1999/xhtml">15.7-1 TwoSquares</h5><div class="func" xmlns="http://www.w3.org/1999/xhtml"><table width="100%" class="func"><tbody><tr><td colspan="1" rowspan="1" class="tdleft"><code class="func">‣ TwoSquares</code>( <var class="Arg">n</var> )</td><td colspan="1" rowspan="1" class="tdright">( function )</td></tr></tbody></table></div><p xmlns="http://www.w3.org/1999/xhtml"><code class="func">TwoSquares</code> returns a list of two integers <math id="8812830802420525905" display="inline" alttext="x\leq y" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mrow xref="p1.1.m1.1.4.cmml" id="p1.1.m1.1.4">
      <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">x</mi>
      <mo xref="p1.1.m1.1.2.cmml" id="p1.1.m1.1.2">≤</mo>
      <mi xref="p1.1.m1.1.3.cmml" id="p1.1.m1.1.3">y</mi>
    </mrow>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <apply xref="p1.1.m1.1.4" id="p1.1.m1.1.4.cmml">
        <leq xref="p1.1.m1.1.2" id="p1.1.m1.1.2.cmml"/>
        <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑥</ci>
        <ci xref="p1.1.m1.1.3" id="p1.1.m1.1.3.cmml">𝑦</ci>
      </apply>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">x\leq y</annotation>
  </semantics>
</math> such that the sum of the squares of <math id="-1056324204694714221" display="inline" alttext="x" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">x</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑥</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">x</annotation>
  </semantics>
</math> and <math id="6714565994598541863" display="inline" alttext="y" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">y</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑦</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">y</annotation>
  </semantics>
</math> is equal to the nonnegative integer <var class="Arg">n</var>, i.e., <math id="1876639658222107496" display="inline" alttext="n=x^{2}+y^{2}" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mrow xref="p1.1.m1.1.8.cmml" id="p1.1.m1.1.8">
      <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">n</mi>
      <mo xref="p1.1.m1.1.2.cmml" id="p1.1.m1.1.2">=</mo>
      <mrow xref="p1.1.m1.1.8.1.cmml" id="p1.1.m1.1.8.1">
        <msup xref="p1.1.m1.1.8.1.1.cmml" id="p1.1.m1.1.8.1.1">
          <mi xref="p1.1.m1.1.3.cmml" id="p1.1.m1.1.3">x</mi>
          <mn xref="p1.1.m1.1.4.1.cmml" id="p1.1.m1.1.4.1">2</mn>
        </msup>
        <mo xref="p1.1.m1.1.5.cmml" id="p1.1.m1.1.5">+</mo>
        <msup xref="p1.1.m1.1.8.1.2.cmml" id="p1.1.m1.1.8.1.2">
          <mi xref="p1.1.m1.1.6.cmml" id="p1.1.m1.1.6">y</mi>
          <mn xref="p1.1.m1.1.7.1.cmml" id="p1.1.m1.1.7.1">2</mn>
        </msup>
      </mrow>
    </mrow>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <apply xref="p1.1.m1.1.8" id="p1.1.m1.1.8.cmml">
        <eq xref="p1.1.m1.1.2" id="p1.1.m1.1.2.cmml"/>
        <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑛</ci>
        <apply xref="p1.1.m1.1.8.1" id="p1.1.m1.1.8.1.cmml">
          <plus xref="p1.1.m1.1.5" id="p1.1.m1.1.5.cmml"/>
          <apply xref="p1.1.m1.1.8.1.1" id="p1.1.m1.1.8.1.1.cmml">
            <csymbol id="p1.1.m1.1.8.1.1.1.cmml" cd="ambiguous">superscript</csymbol>
            <ci xref="p1.1.m1.1.3" id="p1.1.m1.1.3.cmml">𝑥</ci>
            <cn xref="p1.1.m1.1.4.1" id="p1.1.m1.1.4.1.cmml" type="integer">2</cn>
          </apply>
          <apply xref="p1.1.m1.1.8.1.2" id="p1.1.m1.1.8.1.2.cmml">
            <csymbol id="p1.1.m1.1.8.1.2.1.cmml" cd="ambiguous">superscript</csymbol>
            <ci xref="p1.1.m1.1.6" id="p1.1.m1.1.6.cmml">𝑦</ci>
            <cn xref="p1.1.m1.1.7.1" id="p1.1.m1.1.7.1.cmml" type="integer">2</cn>
          </apply>
        </apply>
      </apply>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">n=x^{2}+y^{2}</annotation>
  </semantics>
</math>. If no such representation exists <code class="func">TwoSquares</code> will return <code class="keyw">fail</code>. <code class="func">TwoSquares</code> will return a representation for which the gcd of <math id="7872915899370579411" display="inline" alttext="x" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">x</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑥</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">x</annotation>
  </semantics>
</math> and <math id="-2981293883630418285" display="inline" alttext="y" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">y</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑦</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">y</annotation>
  </semantics>
</math> is as small as possible. It is not specified which representation <code class="func">TwoSquares</code> returns if there is more than one.</p><p xmlns="http://www.w3.org/1999/xhtml">Let <math id="-4674918515776921931" display="inline" alttext="a" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">a</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑎</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">a</annotation>
  </semantics>
</math> be the product of all maximal powers of primes of the form <math id="-7120320078261844788" display="inline" alttext="4k+3" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mrow xref="p1.1.m1.1.5.cmml" id="p1.1.m1.1.5">
      <mrow xref="p1.1.m1.1.5.1.cmml" id="p1.1.m1.1.5.1">
        <mn xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">4</mn>
        <mo xref="p1.1.m1.1.5.1.1.cmml" id="p1.1.m1.1.5.1.1">⁢</mo>
        <mi xref="p1.1.m1.1.2.cmml" id="p1.1.m1.1.2">k</mi>
      </mrow>
      <mo xref="p1.1.m1.1.3.cmml" id="p1.1.m1.1.3">+</mo>
      <mn xref="p1.1.m1.1.4.cmml" id="p1.1.m1.1.4">3</mn>
    </mrow>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <apply xref="p1.1.m1.1.5" id="p1.1.m1.1.5.cmml">
        <plus xref="p1.1.m1.1.3" id="p1.1.m1.1.3.cmml"/>
        <apply xref="p1.1.m1.1.5.1" id="p1.1.m1.1.5.1.cmml">
          <times xref="p1.1.m1.1.5.1.1" id="p1.1.m1.1.5.1.1.cmml"/>
          <cn xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml" type="integer">4</cn>
          <ci xref="p1.1.m1.1.2" id="p1.1.m1.1.2.cmml">𝑘</ci>
        </apply>
        <cn xref="p1.1.m1.1.4" id="p1.1.m1.1.4.cmml" type="integer">3</cn>
      </apply>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">4k+3</annotation>
  </semantics>
</math> dividing <var class="Arg">n</var>. A representation of <var class="Arg">n</var> as a sum of two squares exists if and only if <math id="-8136521349131176788" display="inline" alttext="a" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">a</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑎</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">a</annotation>
  </semantics>
</math> is a perfect square. Let <math id="-7538708910503765286" display="inline" alttext="b" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">b</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑏</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">b</annotation>
  </semantics>
</math> be the maximal power of <math id="4892194319097603896" display="inline" alttext="2" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mn xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">2</mn>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <cn xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml" type="integer">2</cn>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">2</annotation>
  </semantics>
</math> dividing <var class="Arg">n</var> or its half, whichever is a perfect square. Then the minimal possible gcd of <math id="2040855857710976586" display="inline" alttext="x" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">x</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑥</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">x</annotation>
  </semantics>
</math> and <math id="-4004933053134959600" display="inline" alttext="y" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">y</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑦</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">y</annotation>
  </semantics>
</math> is the square root <math id="-1473362751318143461" display="inline" alttext="c" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">c</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑐</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">c</annotation>
  </semantics>
</math> of <math id="367008193960399405" display="inline" alttext="a\cdot b" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mrow xref="p1.1.m1.1.4.cmml" id="p1.1.m1.1.4">
      <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">a</mi>
      <mo xref="p1.1.m1.1.2.cmml" id="p1.1.m1.1.2">⋅</mo>
      <mi xref="p1.1.m1.1.3.cmml" id="p1.1.m1.1.3">b</mi>
    </mrow>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <apply xref="p1.1.m1.1.4" id="p1.1.m1.1.4.cmml">
        <ci xref="p1.1.m1.1.2" id="p1.1.m1.1.2.cmml">⋅</ci>
        <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑎</ci>
        <ci xref="p1.1.m1.1.3" id="p1.1.m1.1.3.cmml">𝑏</ci>
      </apply>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">a\cdot b</annotation>
  </semantics>
</math>. The number of different minimal representation with <math id="-915906968011699018" display="inline" alttext="x\leq y" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mrow xref="p1.1.m1.1.4.cmml" id="p1.1.m1.1.4">
      <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">x</mi>
      <mo xref="p1.1.m1.1.2.cmml" id="p1.1.m1.1.2">≤</mo>
      <mi xref="p1.1.m1.1.3.cmml" id="p1.1.m1.1.3">y</mi>
    </mrow>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <apply xref="p1.1.m1.1.4" id="p1.1.m1.1.4.cmml">
        <leq xref="p1.1.m1.1.2" id="p1.1.m1.1.2.cmml"/>
        <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑥</ci>
        <ci xref="p1.1.m1.1.3" id="p1.1.m1.1.3.cmml">𝑦</ci>
      </apply>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">x\leq y</annotation>
  </semantics>
</math> is <math id="-8882832078029076287" display="inline" alttext="2^{{l-1}}" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <msup xref="p1.1.m1.1.3.cmml" id="p1.1.m1.1.3">
      <mn xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">2</mn>
      <mrow xref="p1.1.m1.1.2.1.cmml" id="p1.1.m1.1.2.1">
        <mi xref="p1.1.m1.1.2.1.1.cmml" id="p1.1.m1.1.2.1.1">l</mi>
        <mo xref="p1.1.m1.1.2.1.2.cmml" id="p1.1.m1.1.2.1.2">-</mo>
        <mn xref="p1.1.m1.1.2.1.3.cmml" id="p1.1.m1.1.2.1.3">1</mn>
      </mrow>
    </msup>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <apply xref="p1.1.m1.1.3" id="p1.1.m1.1.3.cmml">
        <csymbol id="p1.1.m1.1.3.1.cmml" cd="ambiguous">superscript</csymbol>
        <cn xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml" type="integer">2</cn>
        <apply xref="p1.1.m1.1.2.1" id="p1.1.m1.1.2.1.cmml">
          <minus xref="p1.1.m1.1.2.1.2" id="p1.1.m1.1.2.1.2.cmml"/>
          <ci xref="p1.1.m1.1.2.1.1" id="p1.1.m1.1.2.1.1.cmml">𝑙</ci>
          <cn xref="p1.1.m1.1.2.1.3" id="p1.1.m1.1.2.1.3.cmml" type="integer">1</cn>
        </apply>
      </apply>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">2^{{l-1}}</annotation>
  </semantics>
</math>, where <math id="6030661563729674741" display="inline" alttext="l" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">l</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑙</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">l</annotation>
  </semantics>
</math> is the number of different prime factors of the form <math id="6299849524204901468" display="inline" alttext="4k+1" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mrow xref="p1.1.m1.1.5.cmml" id="p1.1.m1.1.5">
      <mrow xref="p1.1.m1.1.5.1.cmml" id="p1.1.m1.1.5.1">
        <mn xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">4</mn>
        <mo xref="p1.1.m1.1.5.1.1.cmml" id="p1.1.m1.1.5.1.1">⁢</mo>
        <mi xref="p1.1.m1.1.2.cmml" id="p1.1.m1.1.2">k</mi>
      </mrow>
      <mo xref="p1.1.m1.1.3.cmml" id="p1.1.m1.1.3">+</mo>
      <mn xref="p1.1.m1.1.4.cmml" id="p1.1.m1.1.4">1</mn>
    </mrow>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <apply xref="p1.1.m1.1.5" id="p1.1.m1.1.5.cmml">
        <plus xref="p1.1.m1.1.3" id="p1.1.m1.1.3.cmml"/>
        <apply xref="p1.1.m1.1.5.1" id="p1.1.m1.1.5.1.cmml">
          <times xref="p1.1.m1.1.5.1.1" id="p1.1.m1.1.5.1.1.cmml"/>
          <cn xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml" type="integer">4</cn>
          <ci xref="p1.1.m1.1.2" id="p1.1.m1.1.2.cmml">𝑘</ci>
        </apply>
        <cn xref="p1.1.m1.1.4" id="p1.1.m1.1.4.cmml" type="integer">1</cn>
      </apply>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">4k+1</annotation>
  </semantics>
</math> of <var class="Arg">n</var>.</p><p xmlns="http://www.w3.org/1999/xhtml">The algorithm first finds a square root <math id="9158831946343754332" display="inline" alttext="r" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">r</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑟</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">r</annotation>
  </semantics>
</math> of <math id="2600064546200326981" display="inline" alttext="-1" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mrow xref="p1.1.m1.1.3.cmml" id="p1.1.m1.1.3">
      <mo xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">-</mo>
      <mn xref="p1.1.m1.1.2.cmml" id="p1.1.m1.1.2">1</mn>
    </mrow>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <apply xref="p1.1.m1.1.3" id="p1.1.m1.1.3.cmml">
        <minus xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml"/>
        <cn xref="p1.1.m1.1.2" id="p1.1.m1.1.2.cmml" type="integer">1</cn>
      </apply>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">-1</annotation>
  </semantics>
</math> modulo <math id="5118327549862092313" display="inline" alttext="\textit{n}/(a\cdot b)" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mrow xref="p1.1.m1.1.8.cmml" id="p1.1.m1.1.8">
      <mtext xref="p1.1.m1.1.1.1.cmml" id="p1.1.m1.1.1.1">𝑛</mtext>
      <mo xref="p1.1.m1.1.2.cmml" id="p1.1.m1.1.2">/</mo>
      <mrow xref="p1.1.m1.1.8.1.2.cmml" id="p1.1.m1.1.8.1">
        <mo id="p1.1.m1.1.3" stretchy="false">(</mo>
        <mrow xref="p1.1.m1.1.8.1.2.cmml" id="p1.1.m1.1.8.1.2">
          <mi xref="p1.1.m1.1.4.cmml" id="p1.1.m1.1.4">a</mi>
          <mo xref="p1.1.m1.1.5.cmml" id="p1.1.m1.1.5">⋅</mo>
          <mi xref="p1.1.m1.1.6.cmml" id="p1.1.m1.1.6">b</mi>
        </mrow>
        <mo id="p1.1.m1.1.7" stretchy="false">)</mo>
      </mrow>
    </mrow>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <apply xref="p1.1.m1.1.8" id="p1.1.m1.1.8.cmml">
        <divide xref="p1.1.m1.1.2" id="p1.1.m1.1.2.cmml"/>
        <mtext xref="p1.1.m1.1.1.1" id="p1.1.m1.1.1.1.cmml">
          <span class="ltx_text ltx_font_italic" xmlns="http://www.w3.org/1999/xhtml">n</span>
        </mtext>
        <apply xref="p1.1.m1.1.8.1" id="p1.1.m1.1.8.1.2.cmml">
          <ci xref="p1.1.m1.1.5" id="p1.1.m1.1.5.cmml">⋅</ci>
          <ci xref="p1.1.m1.1.4" id="p1.1.m1.1.4.cmml">𝑎</ci>
          <ci xref="p1.1.m1.1.6" id="p1.1.m1.1.6.cmml">𝑏</ci>
        </apply>
      </apply>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">\textit{n}/(a\cdot b)</annotation>
  </semantics>
</math>, which must exist, and applies the Euclidean algorithm to <math id="-4895561486937914463" display="inline" alttext="r" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">r</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑟</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">r</annotation>
  </semantics>
</math> and <var class="Arg">n</var>. The first residues in the sequence that are smaller than <math id="-7844507585945794502" display="inline" alttext="\sqrt{{\textit{n}/(a\cdot b)}}" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <msqrt xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">
      <mrow xref="p1.1.m1.1.1.2.cmml" id="p1.1.m1.1.1.2">
        <mtext xref="p1.1.m1.1.1.2.1.1.cmml" id="p1.1.m1.1.1.2.1.1">𝑛</mtext>
        <mo xref="p1.1.m1.1.1.2.2.cmml" id="p1.1.m1.1.1.2.2">/</mo>
        <mrow xref="p1.1.m1.1.1.2.8.2.cmml" id="p1.1.m1.1.1.2.8">
          <mo id="p1.1.m1.1.1.2.3" stretchy="false">(</mo>
          <mrow xref="p1.1.m1.1.1.2.8.2.cmml" id="p1.1.m1.1.1.2.8.2">
            <mi xref="p1.1.m1.1.1.2.4.cmml" id="p1.1.m1.1.1.2.4">a</mi>
            <mo xref="p1.1.m1.1.1.2.5.cmml" id="p1.1.m1.1.1.2.5">⋅</mo>
            <mi xref="p1.1.m1.1.1.2.6.cmml" id="p1.1.m1.1.1.2.6">b</mi>
          </mrow>
          <mo id="p1.1.m1.1.1.2.7" stretchy="false">)</mo>
        </mrow>
      </mrow>
    </msqrt>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <apply xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">
        <root xref="p1.1.m1.1.1" id="p1.1.m1.1.1a.cmml"/>
        <apply xref="p1.1.m1.1.1.2" id="p1.1.m1.1.1.2.cmml">
          <divide xref="p1.1.m1.1.1.2.2" id="p1.1.m1.1.1.2.2.cmml"/>
          <mtext xref="p1.1.m1.1.1.2.1.1" id="p1.1.m1.1.1.2.1.1.cmml">
            <span class="ltx_text ltx_font_italic" xmlns="http://www.w3.org/1999/xhtml">n</span>
          </mtext>
          <apply xref="p1.1.m1.1.1.2.8" id="p1.1.m1.1.1.2.8.2.cmml">
            <ci xref="p1.1.m1.1.1.2.5" id="p1.1.m1.1.1.2.5.cmml">⋅</ci>
            <ci xref="p1.1.m1.1.1.2.4" id="p1.1.m1.1.1.2.4.cmml">𝑎</ci>
            <ci xref="p1.1.m1.1.1.2.6" id="p1.1.m1.1.1.2.6.cmml">𝑏</ci>
          </apply>
        </apply>
      </apply>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">\sqrt{{\textit{n}/(a\cdot b)}}</annotation>
  </semantics>
</math> times <math id="-1843324692580896814" display="inline" alttext="c" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">c</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑐</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">c</annotation>
  </semantics>
</math> are a possible pair <math id="5039555688530792256" display="inline" alttext="x" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">x</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑥</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">x</annotation>
  </semantics>
</math> and <math id="4503622596403364541" display="inline" alttext="y" class="ltx_Math" xmlns="http://www.w3.org/1998/Math/MathML">
  <semantics id="p1.1.m1.1a">
    <mi xref="p1.1.m1.1.1.cmml" id="p1.1.m1.1.1">y</mi>
    <annotation-xml id="p1.1.m1.1b" encoding="MathML-Content">
      <ci xref="p1.1.m1.1.1" id="p1.1.m1.1.1.cmml">𝑦</ci>
    </annotation-xml>
    <annotation id="p1.1.m1.1c" encoding="application/x-tex">y</annotation>
  </semantics>
</math>.</p><p xmlns="http://www.w3.org/1999/xhtml">Better descriptions of the algorithm and related topics can be found in <a shape="rect" href="chapBib_mj.html#biBWagon90">[Wag90]</a> and <a shape="rect" href="chapBib_mj.html#biBZagier90">[Zag90]</a>.</p><div class="example" xmlns="http://www.w3.org/1999/xhtml"><pre xml:space="preserve">
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">TwoSquares( 5 );</span>
[ 1, 2 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">TwoSquares( 11 );  # there is no representation</span>
fail
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">TwoSquares( 16 );</span>
[ 0, 4 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput"># 3 is the minimal possible gcd because 9 divides 45:</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">TwoSquares( 45 );</span>
[ 3, 6 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput"># it is not [5,10] because their gcd is not minimal:</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">TwoSquares( 125 );</span>
[ 2, 11 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput"># [10,11] would be the other possible representation:</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">TwoSquares( 13*17 );</span>
[ 5, 14 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">TwoSquares( 848654483879497562821 );  # argument is prime</span>
[ 6305894639, 28440994650 ]
</pre></div><div class="chlinkprevnextbot" xmlns="http://www.w3.org/1999/xhtml"> <a shape="rect" href="chap0_mj.html">[Top of Book]</a>   <a shape="rect" href="chap0_mj.html#contents">[Contents]</a>    <a shape="rect" href="chap14_mj.html">[Previous Chapter]</a>    <a shape="rect" href="chap16_mj.html">[Next Chapter]</a>   </div><div class="chlinkbot" xmlns="http://www.w3.org/1999/xhtml"><span class="chlink1">Goto Chapter: </span><a shape="rect" href="chap0_mj.html">Top</a>  <a shape="rect" href="chap1_mj.html">1</a>  <a shape="rect" href="chap2_mj.html">2</a>  <a shape="rect" href="chap3_mj.html">3</a>  <a shape="rect" href="chap4_mj.html">4</a>  <a shape="rect" href="chap5_mj.html">5</a>  <a shape="rect" href="chap6_mj.html">6</a>  <a shape="rect" href="chap7_mj.html">7</a>  <a shape="rect" href="chap8_mj.html">8</a>  <a shape="rect" href="chap9_mj.html">9</a>  <a shape="rect" href="chap10_mj.html">10</a>  <a shape="rect" href="chap11_mj.html">11</a>  <a shape="rect" href="chap12_mj.html">12</a>  <a shape="rect" href="chap13_mj.html">13</a>  <a shape="rect" href="chap14_mj.html">14</a>  <a shape="rect" href="chap15_mj.html">15</a>  <a shape="rect" href="chap16_mj.html">16</a>  <a shape="rect" href="chap17_mj.html">17</a>  <a shape="rect" href="chap18_mj.html">18</a>  <a shape="rect" href="chap19_mj.html">19</a>  <a shape="rect" href="chap20_mj.html">20</a>  <a shape="rect" href="chap21_mj.html">21</a>  <a shape="rect" href="chap22_mj.html">22</a>  <a shape="rect" href="chap23_mj.html">23</a>  <a shape="rect" href="chap24_mj.html">24</a>  <a shape="rect" href="chap25_mj.html">25</a>  <a shape="rect" href="chap26_mj.html">26</a>  <a shape="rect" href="chap27_mj.html">27</a>  <a shape="rect" href="chap28_mj.html">28</a>  <a shape="rect" href="chap29_mj.html">29</a>  <a shape="rect" href="chap30_mj.html">30</a>  <a shape="rect" href="chap31_mj.html">31</a>  <a shape="rect" href="chap32_mj.html">32</a>  <a shape="rect" href="chap33_mj.html">33</a>  <a shape="rect" href="chap34_mj.html">34</a>  <a shape="rect" href="chap35_mj.html">35</a>  <a shape="rect" href="chap36_mj.html">36</a>  <a shape="rect" href="chap37_mj.html">37</a>  <a shape="rect" href="chap38_mj.html">38</a>  <a shape="rect" href="chap39_mj.html">39</a>  <a shape="rect" href="chap40_mj.html">40</a>  <a shape="rect" href="chap41_mj.html">41</a>  <a shape="rect" href="chap42_mj.html">42</a>  <a shape="rect" href="chap43_mj.html">43</a>  <a shape="rect" href="chap44_mj.html">44</a>  <a shape="rect" href="chap45_mj.html">45</a>  <a shape="rect" href="chap46_mj.html">46</a>  <a shape="rect" href="chap47_mj.html">47</a>  <a shape="rect" href="chap48_mj.html">48</a>  <a shape="rect" href="chap49_mj.html">49</a>  <a shape="rect" href="chap50_mj.html">50</a>  <a shape="rect" href="chap51_mj.html">51</a>  <a shape="rect" href="chap52_mj.html">52</a>  <a shape="rect" href="chap53_mj.html">53</a>  <a shape="rect" href="chap54_mj.html">54</a>  <a shape="rect" href="chap55_mj.html">55</a>  <a shape="rect" href="chap56_mj.html">56</a>  <a shape="rect" href="chap57_mj.html">57</a>  <a shape="rect" href="chap58_mj.html">58</a>  <a shape="rect" href="chap59_mj.html">59</a>  <a shape="rect" href="chap60_mj.html">60</a>  <a shape="rect" href="chap61_mj.html">61</a>  <a shape="rect" href="chap62_mj.html">62</a>  <a shape="rect" href="chap63_mj.html">63</a>  <a shape="rect" href="chap64_mj.html">64</a>  <a shape="rect" href="chap65_mj.html">65</a>  <a shape="rect" href="chap66_mj.html">66</a>  <a shape="rect" href="chap67_mj.html">67</a>  <a shape="rect" href="chap68_mj.html">68</a>  <a shape="rect" href="chap69_mj.html">69</a>  <a shape="rect" href="chap70_mj.html">70</a>  <a shape="rect" href="chap71_mj.html">71</a>  <a shape="rect" href="chap72_mj.html">72</a>  <a shape="rect" href="chap73_mj.html">73</a>  <a shape="rect" href="chap74_mj.html">74</a>  <a shape="rect" href="chap75_mj.html">75</a>  <a shape="rect" href="chap76_mj.html">76</a>  <a shape="rect" href="chap77_mj.html">77</a>  <a shape="rect" href="chap78_mj.html">78</a>  <a shape="rect" href="chap79_mj.html">79</a>  <a shape="rect" href="chap80_mj.html">80</a>  <a shape="rect" href="chap81_mj.html">81</a>  <a shape="rect" href="chap82_mj.html">82</a>  <a shape="rect" href="chap83_mj.html">83</a>  <a shape="rect" href="chap84_mj.html">84</a>  <a shape="rect" href="chap85_mj.html">85</a>  <a shape="rect" href="chap86_mj.html">86</a>  <a shape="rect" href="chap87_mj.html">87</a>  <a shape="rect" href="chapBib_mj.html">Bib</a>  <a shape="rect" href="chapInd_mj.html">Ind</a>  </div><hr xmlns="http://www.w3.org/1999/xhtml"/><p class="foot" xmlns="http://www.w3.org/1999/xhtml">generated by <a shape="rect" href="http://www.math.rwth-aachen.de/~Frank.Luebeck/GAPDoc">GAPDoc2HTML</a></p> </body>
    </html>