<html> 
      <head>
        <title>GAP (ref) - Chapter 80: Examples of Extending the System &amp;#8614; 80.6 Adding a new Representation</title>
        <meta name="url" content="http://www.gap-system.org/Manuals/doc/ref/chap80_mj.html#X8111D831783C9ED6"></meta>
      </head>
      <body> <h4 xmlns="http://www.w3.org/1999/xhtml">80.6 <span class="Heading">Adding a new Representation</span></h4><p xmlns="http://www.w3.org/1999/xhtml">Next, we look at the implementation of a new representation of existing objects. In most cases we want to implement this representation only for efficiency reasons while keeping all the existing functionality.</p><p xmlns="http://www.w3.org/1999/xhtml">For example, assume we wanted (following <a shape="rect" href="chapBib_mj.html#biBwielandt69">[Wie69]</a>) to implement permutation groups defined by relations.</p><p xmlns="http://www.w3.org/1999/xhtml">Next, we have to decide a few basics about the representation. All existing permutation groups in the library are attribute storing and we probably want to keep this for our new objects. Thus the representation must be a subrepresentation of <code class="code">IsComponentObjectRep and IsAttributeStoringRep</code>. Furthermore we want each object to be a permutation group and we can imply this directly in the representation.</p><p xmlns="http://www.w3.org/1999/xhtml">We also decide that we store the degree (the largest point that might be moved) in a component <code class="code">degree</code> and the defining relations in a component <code class="code">relations</code> (we do not specify the format of relations here. In an actual implementation one would have to design this as well, but it does not affect the declarations this chapter is about).</p><div class="example" xmlns="http://www.w3.org/1999/xhtml"><pre xml:space="preserve">
IsPermutationGroupByRelations:=NewRepresentation(
  &quot;IsPermutationGroupByRelations&quot;,
  IsComponentObjectRep and IsAttributeStoringRep and IsPermGroup,
  [&quot;degree&quot;,&quot;relations&quot;]);
</pre></div><p xmlns="http://www.w3.org/1999/xhtml">(If we wanted to implement sparse matrices we might for example rather settle for a positional object in which we store a list of the nonzero entries.)</p><p xmlns="http://www.w3.org/1999/xhtml">We can make the new representation a subrepresentation of an existing one. In such a case of course we have to provide all structure of this &quot;parent&quot; representation as well.</p><p xmlns="http://www.w3.org/1999/xhtml">Next we need to check in which family our new objects will be. This will be the same family as of every other permutation group, namely the <code class="code">CollectionsFamily(PermutationsFamily)</code> (where the family <code class="code">PermutationsFamily = FamilyObj((1,2,3))</code> has been defined already in the library).</p><p xmlns="http://www.w3.org/1999/xhtml">Now we can write a function to create our new objects. Usually it is helpful to look at functions from the library that are used in similar situations (for example <code class="func">GroupByGenerators</code> (<a shape="rect" href="chap39_mj.html#X7F81960287F3E32A"><span class="RefLink">39.2-2</span></a>) in our case) to make sure we have not forgotten any further requirements in the declaration we might have to add here. However in most cases the function is straightforward:</p><div class="example" xmlns="http://www.w3.org/1999/xhtml"><pre xml:space="preserve">
PermutationGroupByRelations:=function(degree,relations)
local g
  g:=Objectify(NewType(CollectionsFamily(PermutationsFamily),
         IsPermutationGroupByRelations),
               rec(degree:=degree,relations:=relations));
end;
</pre></div><p xmlns="http://www.w3.org/1999/xhtml">It also is a good idea to install a <code class="func">PrintObj</code> (<a shape="rect" href="chap6_mj.html#X815BF22186FD43C9"><span class="RefLink">6.3-5</span></a>) and possibly also a <code class="func">ViewObj</code> (<a shape="rect" href="chap6_mj.html#X815BF22186FD43C9"><span class="RefLink">6.3-5</span></a>) method â€“otherwise testing becomes quite hard:</p><div class="example" xmlns="http://www.w3.org/1999/xhtml"><pre xml:space="preserve">
InstallMethod(PrintObj,&quot;for perm grps. given by relations&quot;,
  [IsPermutationGroupByRelations],
function(G)
  Print(&quot;PermutationGroupByRelations(&quot;, G!.degree,&quot;,&quot;,G!.relations,&quot;)&quot;);
end);
</pre></div><p xmlns="http://www.w3.org/1999/xhtml">Next we have to write enough methods for the new representation so that the existing algorithms can be used. In particular we will have to implement methods for all operations for which library or kernel provides methods for the existing (alternative) representations. In our particular case there are no such methods. (If we would have implemented sparse matrices we would have had to implement methods for the list access and assignment functions, see <a shape="rect" href="chap21_mj.html#X7B202D147A5C2884"><span class="RefLink">21.2</span></a>.) However the existing way permutation groups are represented is by generators. To be able to use the existing machinery we want to be able to obtain a generating set also for groups in our new representation. This can be done (albeit not very effectively) by a stabilizer calculation in the symmetric group given by the <code class="code">degree</code> component. The operation function to use is probably a bit complicated and will depend on the format of the <code class="code">relations</code> (we have not specified in this example). In the following method we use <code class="code">operationfunction</code> as a placeholder;</p><div class="example" xmlns="http://www.w3.org/1999/xhtml"><pre xml:space="preserve">
InstallMethod(GeneratorsOfGroup,&quot;for perm grps. given by relations&quot;,
  [IsPermutationGroupByRelations],
function(G)
local S,U;
  S:=SymmetricGroup(G!.degree);
  U:=Stabilizer(S,G!.relations,  operationfunction );
  return GeneratorsOfGroup(U);
end);
</pre></div><p xmlns="http://www.w3.org/1999/xhtml">This is all we <em>must</em> do. Of course for performance reasons one might want to install methods for further operations as well.</p> </body>
    </html>